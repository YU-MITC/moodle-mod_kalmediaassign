{"version":3,"sources":["../src/preview.js"],"names":["define","$","init","argWidth","argHeight","modalX","modalY","modalWidth","modalHeight","centeringModalSyncer","w","window","width","h","height","parseInt","css","cw","outerWidth","ch","outerHeight","fadeInModalWindow","blur","dElm","document","documentElement","dBody","body","scrollLeft","scrollTop","append","fadeIn","fadeOutModalWindow","scrollTo","fadeOut","remove","createPreviewPanel","element","str","html","on","updateHiddenMarkup","entryid","kalturahost","partnerid","uiconfid","modalwidth","modalheight","date","Date","datetime","getTime","val","onresize","id"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Scripts for mod_kalmediaassign\n *\n * @package    mod_kalmediaassign\n * @copyright  (C) 2016-2020 Yamaguchi University (gh-cc@mlex.cc.yamaguchi-u.ac.jp)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module mod_kalmediaassign/preview\n */\n\ndefine(['jquery'], function($) {\n\n    return {\n        /**\n         * Initial function.\n         * @access public\n         * @param {int} argWidth - width of modal content for preview.\n         * @param {int} argHeight - height of modal content for preview.\n         */\n        init: function(argWidth, argHeight) {\n\n            var modalX = 0;\n            var modalY = 0;\n            var modalWidth = argWidth;\n            var modalHeight = argHeight;\n\n            /**\n             * This function centerize modal window.\n             */\n            function centeringModalSyncer() {\n\n                // Get width and height of window.\n                var w = $(window).width();\n                var h = $(window).height();\n\n                var width = parseInt(modalWidth);\n                var height = parseInt(modalHeight);\n\n                $(\"#modal_content\").css({\"width\": (width + 40) + \"px\", \"height\": (height + 40) + \"px\"});\n\n                // Get width and height of content area.\n                var cw = $(\"#modal_content\").outerWidth();\n                var ch = $(\"#modal_content\").outerHeight();\n\n                // Execute centering.\n                $(\"#modal_content\").css({\"left\": ((w - cw) / 2) + \"px\", \"top\": ((h - ch) / 2) + \"px\"});\n            }\n\n            /**\n             * This function print modal window.\n             * @return {bool} - if modal window opend, return true. Otherwise, return false.\n             */\n            function fadeInModalWindow() {\n                // All contents in web page release focus.\n                $(this).blur();\n                // Precent dupulicate execute of modal window.\n                if ($(\"#modal_window\")[0]) {\n                    return false;\n                }\n\n                var width = parseInt(modalWidth);\n                var height = parseInt(modalHeight);\n\n                $(\"#modal_content\").css({\"width\": (width + 40) + \"px\", \"height\": (height + 40) + \"px\"});\n\n                // Record current scroll position.\n                var dElm = document.documentElement;\n                var dBody = document.body;\n                modalX = dElm.scrollLeft || dBody.scrollLeft; // Get x value of current position.\n                modalY = dElm.scrollTop || dBody.scrollTop; // Get y valueion of current position.\n                // Create modal window and a content area.\n                $(\"body\").append(\"<div id=\\\"modal_content\\\"></div>\");\n                $(\"body\").append(\"<div id=\\\"modal_window\\\"></div>\");\n                $(\"#modal_window\").fadeIn(\"normal\");\n\n                // Centering content area.\n                centeringModalSyncer();\n                // Fade-in content area.\n                $(\"#modal_content\").fadeIn(\"normal\");\n\n                return true;\n            }\n\n            /**\n             * This function delete content area and modal window.\n             */\n            function fadeOutModalWindow() {\n                // Rescore scroll position to web brawser.\n                window.scrollTo(modalX, modalY);\n\n                // Fade-put content area and modal window.\n                $(\"#modal_content,#modal_window\").fadeOut(\"normal\", function() {\n                    $(\"#modal_window\").remove();\n                    $(\"#modal_content\").remove();\n                });\n            }\n\n            /**\n             * This function create preview panel\n             */\n            function createPreviewPanel() {\n                // View modal window.\n                fadeInModalWindow();\n\n                var element = $(\"#hidden_markup\");\n                var str = '';\n                str += \"<center>\";\n\n                if (element !== null) {\n                    str += element.html();\n                } else {\n                    str += \"Sorry! Media not found.\";\n                }\n\n                str += \"</center>\";\n                str += \"<center>\";\n                str += \"<input type=\\\"button\\\" id=\\\"cancel_btn\\\" value=\\\"Close\\\">\";\n                str += \"</center>\";\n\n                $(\"#modal_content\").append(str);\n\n                $(\"#cancel_btn\").on(\"click\", function() {\n                    fadeOutModalWindow();\n                });\n            }\n\n            /**\n             * This function update hidden markup for preview.\n             */\n            function updateHiddenMarkup() {\n                var element = null;\n                var entryid = \"\";\n                var kalturahost = \"\";\n                var partnerid = \"\";\n                var uiconfid = \"\";\n                var modalwidth = \"\";\n                var modalheight = \"\";\n\n                var date = new Date();\n                var datetime = date.getTime();\n\n                element = $(\"#entry_id\");\n                if (element !== null) {\n                    entryid = element.val();\n                }\n\n                element = $(\"#kalturahost\");\n                if (element !== null) {\n                    kalturahost = element.val();\n                }\n\n                element = $(\"#partner_id\");\n                if (element !== null) {\n                    partnerid = element.val();\n                }\n\n                element = $(\"#uiconfid\");\n                if (element !== null) {\n                    uiconfid = element.val();\n                }\n\n                element = $(\"#modalwidth\");\n                if (element !== null) {\n                    modalwidth = element.val();\n                }\n\n                element = $(\"#modalheight\");\n                if (element !== null) {\n                    modalheight = element.val();\n                }\n\n                element = $(\"#hidden_markup\");\n\n                if (element !== null && entryid !== \"\" && kalturahost !== \"\" && partnerid !== \"\" &&\n                    uiconfid !== \"\" && modalwidth !== \"\" && modalheight !== \"\") {\n                    var str = \"<iframe src=\\\"\" + kalturahost + \"/p/\" + partnerid + \"/sp/\" + partnerid + \"00\";\n                    str = str + \"/embedIframeJs/uiconf_id/\" + uiconfid + \"/partnerid\" + partnerid;\n                    str = str + \"?iframeembed=true&playerId=kaltura_player_\" + datetime;\n                    str = str + \"&entry_id=\" + entryid + \"\\\" width=\\\"\" + modalwidth + \"\\\" height=\\\"\" + modalheight + \"\\\" \";\n                    str = str + \"allowfullscreen webkitallowfullscreen mozAllowFullScreen frameborder=\\\"0\\\"></iframe>\";\n                    element.html(\"\");\n                    element.html(str);\n                }\n            }\n\n            // Entry a uload event callback.\n            $(window).on(\"unload\", function() {\n                // If window is resize, call modal window centerize function.\n                window.onresize = centeringModalSyncer;\n            });\n\n            $(\".media_thumbnail_cl\").on(\"click\", function() {\n                var element = $(\"#entry_id\");\n                var id = \"\";\n\n                if (element !== null) {\n                    id = element.val();\n                }\n                if (id !== null && id !== \"\") {\n                    createPreviewPanel();\n                }\n            });\n\n            $(\"#media_thumbnail\").on(\"load\", function() {\n                updateHiddenMarkup();\n            });\n        }\n    };\n\n});\n"],"file":"preview.min.js"}